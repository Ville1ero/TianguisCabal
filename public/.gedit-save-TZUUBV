<?php 
/**
 * Front Controller for the application
 * @package TianguisCabal
 */
 
/*
 * Paths for the application
 *
 * Copied directly from zf-tool's generated Front Controller.
 */
defined('APPLICATION_PATH')
    || define('APPLICATION_PATH', realpath(dirname(__FILE__) .
    '/../application'));

// Ensure library/ is on include_path
set_include_path( implode( PATH_SEPARATOR, array(
    realpath( APPLICATION_PATH . '/../library' ),
    get_include_path(),
)));

/*
 * Autoloader
 *
 * This will ensure that we don't need to include stuff; it will do it for us.
 */
function __autoload($class_name)
{
    $path = str_replace('_', '/', $class_name);
    echo "require_once " . APPLICATION_PATH . " . '/' . $path . '.php';";
    exit;
}

/*
 * @todo set includepath
 * ini_set('include_path', '');
 */
include_once APPLICATION_PATH . "/controllers/TestController.inc.php";

/**
 * URL = TianguisCabal/test/test/1
 * url_rewrite= TianguisCabal/index.php&controller=test&method=test&value=1
 * test => TestController
 * TEST => testAction
 */

if( isset( $_GET['controller'] ) OR isset( $_GET['action'] ) ) {
    $controller = "controllers_IndexController";
    $method     = "indexAction";
    $value      = null;
} else {
    $controller = ucwords( $_GET['controller'] ) . "Controller";
    $method     = strtolower( $_GET['action'] ) . "Action";
    $value      = ( isset( $_GET['value'] ) ) ? '' : $_GET['value'];
}

$Controller = new $controller();
$Controller->$method( $value );
